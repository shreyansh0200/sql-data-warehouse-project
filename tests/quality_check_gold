--checking data integrity



select distinct 

ci.cst_gndr,
ca.GEN ,
case 
	when ci.cst_gndr != 'n/a' then ci.cst_gndr --crm is master for gender info.
	else coalesce(ca.gen,'n/a' )
end new_gen

from [silver].[crm_cust_info] ci
left join [silver].[erp_CUST_AZ12] ca
on ci.cst_key=ca.cid
left join [silver].[erp_LOC_A101] la
on ci.cst_key=la.cid
order by 1,2

-- expectation :no result of fact
select * 
from [gold].[fact_sales] f
left join [gold].[dim_customers] c
on c.customer_key=f.customer_key
left join [gold].[dim_products] p
on f.product_key=p.product_key
where c.customer_key is null
or product_key is null

select top 2 * from [gold].[fact_sales]
select top 2 * from [gold].[dim_products]


-- quality checke gold view

select top 10 * from [gold].[dim_customers]
select * from [gold].[dim_products]

